import{FunctionGraph as e,setupAudio as t,setupPlayerControls as n}from"./common.js";window.onload=(()=>{const i=new e(document.getElementById("funccanvas"));i.ylim=[-130,0],t("qdsproc.js","qds-processor").then(e=>{e.proc.w=16,e.proc.dither=!0,e.proc.dithertype="rect",e.proc.noiseshaping=!0,e.proc.noiseshapingfilter=1,n(e,[{type:"sine"},{type:"remote",label:"Music",url:"audio/unfinite_function.mp3"}]);const t=new Float32Array(e.getFrequencyDomainData());for(let e=0;e<t.length;e++)t[e]=22050*e/(t.length-1);const c=new Float32Array(e.getTimeDomainData());for(let e=0;e<c.length;e++)c[e]=e;let o=!1;!function n(){if(setTimeout(()=>requestAnimationFrame(n),40),o){const t=e.getTimeDomainData();i.drawData(c,t)}else{const n=e.getFrequencyDomainData();i.drawData(t,n)}}();const d=document.getElementById("linear");function a(e){o=e,e?(i.logx=!1,i.ylim=[-1,1],i.xlim=[0,c.length-1],i.xlabel="time in samples",i.ylabel="amplitude",d.style.visibility="hidden",d.labels[0].style.visibility="hidden"):(i.xlim=[50,2e4],i.logx=!d.checked,i.ylim=[-130,0],i.xlabel="frequency in Hz",i.ylabel="magnitude in dB",d.style.visibility="visible",d.labels[0].style.visibility="visible")}function l(){document.getElementById("dither").checked?document.getElementById("noiseshaping").checked?document.getElementById("diagram").src="images/qds/ns5.png":document.getElementById("diagram").src="images/qds/ns5b.png":document.getElementById("noiseshaping").checked?document.getElementById("diagram").src="images/qds/ns5c.png":document.getElementById("diagram").src="images/qds/ns5d.png"}d.checked=!1,d.onchange=function(e){o||(i.logx=!e.target.checked)},document.getElementById("spectrum").onchange=(e=>{a(!e.target.checked)}),document.getElementById("waveform").onchange=(e=>{a(e.target.checked)}),a(!1),document.getElementById("wordlength").value=16,document.getElementById("wordlength").onchange=function(t){e.proc.w=t.target.value},document.getElementById("dither").checked=!0,document.getElementById("dither").onchange=function(t){e.proc.dither=t.target.checked,l()},document.getElementById("noiseshaping").checked=!0,document.getElementById("noiseshaping").onchange=function(t){e.proc.noiseshaping=t.target.checked,l()},document.getElementById("dithertype").value="rect",document.getElementById("dithertype").onchange=function(t){e.proc.dithertype=t.target.value},document.getElementById("noiseshapingfilter").value=1,document.getElementById("noiseshapingfilter").onchange=function(t){e.proc.noiseshapingfilter=t.target.value}})});