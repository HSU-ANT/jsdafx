const e="object"==typeof global?global:self,t=[].findIndex||function(e,t){let n=this.length;for(;n--;)if(e.call(t,this[n]))return n;return n},n=Object.defineProperty,i="__event-target__"+Math.random(),o=e.WeakMap||function(){return{get:e=>e[i],set(e,t){n(e,i,{configurable:!0,value:t})}}};let r=e.EventTarget;try{new r}catch(e){r=(()=>{const e=new o,i=t=>e.get(t)||r(t),r=t=>{const n=new f;return e.set(t,n),n},l=(e,t)=>{for(const i in t)n(e,i,{configurable:!0,value:t[i]})};function s(){}function a(e){const t=e.options;t&&t.once&&u.call(e.target,this.type,e.listener,e.options),"function"==typeof e.listener?e.listener.call(e.target,this):e.listener.handleEvent(this)}function c(e){return this===e.listener}function u(e,n,o){const r=i(this)[e];if(r){const e=t.call(r,c,n);-1<e&&r.splice(e,1)}}function f(){}return l(s.prototype,{addEventListener:function(e,n,o){const r=i(this),l=r[e]||(r[e]=[]);t.call(l,c,n)<0&&l.push({target:this,listener:n,options:o})},dispatchEvent:function(e){const t=i(this)[e.type];t&&(l(e,{currentTarget:this,target:this}),t.forEach(a,e),delete e.currentTarget,delete e.target);return!0},removeEventListener:u}),f.prototype=Object.create(null),s})()}var l=r;function s(e){let{width:t,height:n}=e;const i=e.getContext("2d");let o=!0,r=2e4,l=50,s=null,a=0,c=-80,u=null,f=[],h=null,d=null,p=null,m=30;let v=t-m-10;const g=10;let y=17,T=n-g-y,b=null;const w=function(e){return(r-l)*(e-m)/v+l},k=function(e){return l*Math.pow(10,Math.log10(r/l)*(e-m)/v)};let x=k;const E=function(e){return(e-l)*v/(r-l)+m},M=function(e){return Math.log10(e/l)/Math.log10(r/l)*v+m};let A=M;const P=function(e){return g+T/(c-a)*(e-a)},S=function(e){return a+(e-g)*(c-a)/T},D=function(e){const t=Math.pow(10,Math.floor(Math.log10(e)));return(e/=t)>5?e=10:e>2?e=5:e>1&&(e=2),e*t},L=function(){i.clearRect(0,0,t,n),i.font="12px sans-serif",i.textBaseline="middle",i.textAlign="end";const e=D((r-l)/v*30),f=D((a-c)/T*20),h=f>=1?0:-Math.floor(Math.log10(f));for(let e=Math.floor(a/f)*f;e>=c;e-=f)i.strokeStyle="rgb(0, 0, 0)",i.fillText(e.toFixed(h),m-2,P(e));if(i.textBaseline="top",i.textAlign="center",i.setTransform(0,-1,1,0,0,0),u&&i.fillText(u,-(T/2+g),0),i.setTransform(1,0,0,1,0,0),o){i.strokeStyle="rgb(0, 0, 0)";for(let e=Math.pow(10,Math.ceil(Math.log10(l)));e<=r;e*=10)i.fillText(e,A(e),n-y+2)}else{i.strokeStyle="rgb(0, 0, 0)";const t=e>=1?0:-Math.floor(Math.log10(e));for(let o=Math.ceil(l/e)*e;o<=r;o+=e)i.fillText(o.toFixed(t),A(o),n-y+2)}s&&i.fillText(s,m+(t-m)/2,n-y+16);for(let e=Math.floor(a/f)*f;e>=c;e-=f)i.strokeStyle="rgb(100, 100, 100)",i.beginPath(),i.moveTo(A(l),P(e)),i.lineTo(A(r),P(e)),i.stroke();if(o){let e=Math.pow(10,Math.floor(Math.log10(l))),t=Math.ceil(l/e)*e;for(i.strokeStyle="rgb(100, 100, 100)";t<=r;){i.beginPath();const n=A(t);i.moveTo(n,P(a)),i.lineTo(n,P(c)),i.stroke(),t+=e,t>=9.99*e&&(e*=10)}}else for(let t=Math.ceil(l/e)*e;t<=r;t+=e){i.beginPath();const e=A(t);i.moveTo(e,P(a)),i.lineTo(e,P(c)),i.stroke()}i.rect(A(l),P(c),A(r)-A(l),P(a)-P(c)),i.stroke(),b=i.getImageData(0,0,t,n)};this.envelopeMode=!1;let B=[];const C=()=>{i.putImageData(b,0,0),i.save(),i.beginPath(),i.rect(m,g,t-m-10,n-y-g),i.clip();for(let e=0;e+1<B.length;e+=2){const t=B[e],n=B[e+1];e+2<B.length&&"string"==typeof B[e+2]?(i.strokeStyle=B[e+2],e++):i.strokeStyle="rgb(0, 0, 0)",i.beginPath(),i.moveTo(A(t[0]),P(n[0]));for(let e=1;e<n.length;e++)i.lineTo(A(t[e]),P(n[e]));if(this.envelopeMode){for(let e=n.length-1;e>=0;e--)i.lineTo(A(t[e]),P(-n[e]));i.fill()}else i.stroke()}i.restore()};this.drawData=function(...e){B=e,C()},this.drawMarkers=function(e){i.save(),i.fillStyle="rgb(165, 0, 52)",f=[];for(const t of e)f.push([A(t[0]),P(t[1])]),i.beginPath(),i.arc(A(t[0]),P(t[1]),4,0,2*Math.PI),i.fill();i.restore()},Object.defineProperty(this,"xlim",{get:()=>[l,l],set(e){[l,r]=e,L(),C()}}),Object.defineProperty(this,"ylim",{get:()=>[c,c],set(e){[c,a]=e,L(),C()}}),Object.defineProperty(this,"logx",{get:()=>o,set(e){o=e,o?(x=k,A=M):(x=w,A=E),L(),C()}}),Object.defineProperty(this,"xlabel",{get:()=>s,set(e){s=e,y=s?30:16,T=n-g-y,L(),C()}}),Object.defineProperty(this,"ylabel",{get:()=>u,set(e){u=e,m=u?44:30,v=t-m-10,L(),C()}});const R=(e,t,n)=>{h=null;let i=n;for(let n=0;n<f.length;n++){const o=f[n],r=Math.hypot(e-o[0],t-o[1]);r<=i&&(h=n,i=r)}null!==h&&(d=e-f[h][0],p=t-f[h][1])};e.addEventListener("mousedown",(e=>{0===e.button&&R(e.offsetX,e.offsetY,6)})),e.addEventListener("touchstart",(e=>{e.preventDefault(),null===h&&R(e.touches.item(0).pageX-e.target.offsetLeft,e.touches.item(0).pageY-e.target.offsetTop,40)}));const O=()=>{if(null!==h){const e=new Event("markermoveend");e.marker=h,this.dispatchEvent(e),h=null}};e.addEventListener("mouseup",(e=>{0===e.button&&O()})),e.addEventListener("touchend",(e=>{e.preventDefault(),0===e.touches.length&&O()}));const W=(e,t)=>{if(null===h)return;const n=new Event("markermove");n.marker=h,n.valX=x(e-d),n.valY=S(t-p),this.dispatchEvent(n)};e.addEventListener("mousemove",(e=>{1===e.buttons?W(e.offsetX,e.offsetY):O()})),e.addEventListener("touchmove",(e=>{e.preventDefault(),W(e.touches.item(0).pageX-e.target.offsetLeft,e.touches.item(0).pageY-e.target.offsetTop)}));new ResizeObserver((e=>{for(const i of e)i.contentBoxSize?i.contentBoxSize[0]?(t=i.contentBoxSize[0].inlineSize,n=i.contentBoxSize[0].blockSize):(t=i.contentBoxSize.inlineSize,n=i.contentBoxSize.blockSize):(t=i.contentRect.width,n=i.contentRect.height);const i=f.map((([e,t])=>[x(e),S(t)]));v=t-m-10,T=n-g-y,L(),C(),this.drawMarkers(i)})).observe(e)}class a extends l{constructor(e){super(),s.call(this,e)}}function c(e,t){const n=new a(t);let i=!1,o=!1;Object.defineProperty(this,"drawWave",{get:()=>i,set(t){i=t,t?(n.logx=!1,n.ylim=[-1,1],n.xlim=[0,e.timeIndices.length-1],n.xlabel="time in samples",n.ylabel="amplitude"):(n.xlim=[50,2e4],n.logx=!o,n.ylim=[-130,0],n.xlabel="frequency in Hz",n.ylabel="magnitude in dB")}}),Object.defineProperty(this,"freqLinear",{get:()=>o,set(e){o=e,i||(n.logx=!o)}}),this.drawWave=!1,function t(){if(setTimeout((()=>requestAnimationFrame(t)),40),i){const t=e.getTimeDomainData();n.drawData(e.timeIndices,t)}else{const t=e.getFrequencyDomainData();n.drawData(e.frequencies,t)}}()}async function u(...e){const t=new(window.AudioContext||window.webkitAudioContext)({latencyHint:"playback"});let n=null,i=null,o=null;const r=t.createAnalyser();r.smoothingTimeConstant=.3,r.minDecibels=-130,r.fftSize=1024;const l=new Float32Array(r.fftSize),s=new Float32Array(r.frequencyBinCount);r.connect(t.destination);let a=null,c=0;await t.audioWorklet.addModule("noisesourceproc.js");const u="object"==typeof e[0]?e[0]:function(e,t){return{init:async n=>{await n.audioWorklet.addModule(e);const i=new AudioWorkletNode(n,t);i.port.postMessage({action:"list-properties"});const o=await(r=i.port,new Promise((e=>{const t=r.onmessage;r.onmessage=n=>{r.onmessage=t,e(n.data)}})));var r;if("list-properties"===o.response)for(const e of o.properties)Object.defineProperty(i,e,{set(t){i.port.postMessage({action:"set-property",param:e,value:t})}});return i},setup:(e,t,n)=>{t.connect(e),e.connect(n)},teardown:e=>{e.disconnect()}}}(...e),f=await u.init(t),h=new Float32Array(r.frequencyBinCount);for(let e=0;e<h.length;e++)h[e]=e*t.sampleRate/2/(h.length-1);const d=new Float32Array(r.fftSize);for(let e=0;e<d.length;e++)d[e]=e;const p=function(){a=null,null!==n&&(n.disconnect(),n=null),null!==i&&(i.disconnect(),i=null),u.teardown(f),t.suspend()};return p(),{start:function(e,l,s){if(p(),t.resume(),a=t.currentTime,e instanceof AudioBuffer)n=t.createBufferSource(),n.buffer=e,c=void 0===l?0:l,void 0!==s&&(n.loopStart=c,n.loopEnd=s),n.loop=!0,n.start(0,c),u.setup(f,n,r);else if("sine"===e.type)n=t.createOscillator(),n.type="sine",n.frequency.value=e.frequency,n.start(),i=t.createGain(),i.gain.value=e.gain,n.connect(i),u.setup(f,i,r);else if("noise"===e.type){if(i=t.createGain(),i.gain.value=e.gain,n=new AudioWorkletNode(t,"noisesource-processor",{numberOfInputs:0,outputChannelCount:[1]}),e.filter&&0!==e.filter.length){o=t.createConvolver();const r=t.createBuffer(1,e.filter.length,t.sampleRate);r.getChannelData(0).set(e.filter),o.normalize=!1,o.buffer=r,n.connect(o),o.connect(i)}else n.connect(i);u.setup(f,i,r)}},stop:p,isPlaying:()=>null!==n,createBuffer:e=>new Promise((n=>{t.decodeAudioData(e,n)})),getTimeDomainData:function(){return r.getFloatTimeDomainData(l),l},timeIndices:d,getFrequencyDomainData:function(){return r.getFloatFrequencyData(s),s},frequencies:h,proc:f,get currentTime(){return t.currentTime},get sampleRate(){return t.sampleRate},get position(){if(null===a)return null;let e=this.currentTime-a;return n instanceof AudioBufferSourceNode&&(e=0!==n.loopEnd?e%(n.loopEnd-n.loopStart)+n.loopStart:(e+c)%n.buffer.duration),e}}}class f extends l{constructor(e){super();const t=e.getContext("2d"),{width:n,height:i}=e,o=Array(n),r=Array(n);let l=null,s=null,a=null,c=null,u=null,f=null;const h=()=>{if(t.fillStyle="rgb(221, 218, 215)",t.strokeStyle="rgb(186, 180, 175)",t.fillRect(0,0,n,i),t.strokeRect(0,0,n,i),l instanceof AudioBuffer){t.fillStyle="rgb(186, 180, 175)",null!==a&&(null!==s?t.fillRect(a,0,s-a,i):(t.beginPath(),t.moveTo(a,0),t.lineTo(a,i),t.stroke())),null!==c&&null!==u&&t.fillRect(c,0,u-c,i),t.fillStyle="black",t.beginPath(),t.moveTo(0,i/2);for(let e=0;e<n;e++)t.lineTo(e,(o[e]+1)*i/2);for(let e=n-1;e>=0;e--)t.lineTo(e,(r[e]+1)*i/2);if(t.fill(),null!==f){const e=Math.round(f/l.duration*n);t.lineWidth=1,t.strokeStyle="rgb(165, 0, 52)",t.beginPath(),t.moveTo(e,0),t.lineTo(e,i),t.stroke(),t.strokeStyle="white",t.beginPath(),t.moveTo(e,(r[e]+1)*i/2),t.lineTo(e,(o[e]+1)*i/2),t.stroke()}}},d=e=>{s=e,a=null,c=null,u=null},p=e=>{a=e,h()},m=()=>{if(null!==s){if(l instanceof AudioBuffer)if(null!==a&&a!==s){s>a&&([s,a]=[a,s]);const e=new Event("selected");e.startPos=s*l.length/n/l.sampleRate,e.endPos=a*l.length/n/l.sampleRate,this.dispatchEvent(e),c=s,u=a}else{const e=new Event("clicked");e.position=s*l.length/n/l.sampleRate,this.dispatchEvent(e)}s=null,a=null,h()}};e.addEventListener("mousedown",(e=>{0===e.button&&d(e.offsetX)})),e.addEventListener("touchstart",(e=>{e.preventDefault(),d(e.touches.item(0).pageX-e.target.offsetLeft)})),e.addEventListener("mousemove",(e=>{p(e.offsetX)})),e.addEventListener("touchmove",(e=>{e.preventDefault(),p(e.touches.item(0).pageX-e.target.offsetLeft)})),e.addEventListener("mouseup",(e=>{0===e.button&&m()})),e.addEventListener("touchend",(e=>{e.preventDefault(),0===e.touches.length&&m()})),e.addEventListener("mouseleave",(()=>{null===s&&(a=null,h())})),Object.defineProperty(this,"signal",{set(e){if(e instanceof AudioBuffer){l=e,o.fill(-1),r.fill(1);for(let e=0;e<l.numberOfChannels;e++){const t=l.getChannelData(e);for(let e=0;e<t.length;e++){const i=Math.round(e*n/t.length);t[e]>o[i]&&(o[i]=t[e]),t[e]<r[i]&&(r[i]=t[e])}}}else l=null;c=null,u=null,h()}}),Object.defineProperty(this,"selection",{get:()=>null!==c&&null!==u?{start:c*l.length/n/l.sampleRate,end:u*l.length/n/l.sampleRate}:null}),Object.defineProperty(this,"playbackPosition",{set(e){f=e,h()}})}}function h(e,t){const n=[];let i=null;const o=document.getElementById("source-select"),r=o.children[1];o.children[0].addEventListener("click",(e=>{e.stopPropagation(),r.style.visibility="visible"===r.style.visibility?"hidden":"visible"}),!1),document.addEventListener("click",(()=>{r.style.visibility="hidden"}),!1);const l=document.getElementById("play"),s=document.getElementById("stop"),a=new f(document.getElementById("timelinecanvas"));function c(){e.isPlaying()?(l.disabled=!0,s.disabled=!1):(s.disabled=!0,l.disabled=!n[i])}function u(t){i=Number(t.getAttribute("data-source-idx")),o.children[0].innerText=t.textContent,function e(t){t.classList.remove("selected"),Array.from(t.children).forEach(e)}(r),t.classList.add("selected"),e.stop(),c(),a.signal=n[i]}function h(e,t){e.innerText=t,Number(e.getAttribute("data-source-idx"))===i&&(o.children[0].innerText=t)}t.forEach((async function(t){const o=document.createElement("div");if(o.setAttribute("data-source-idx",n.length),r.children[0].append(o),o.addEventListener("click",(e=>{u(e.target)})),"remote"===t.type){o.innerText=`${t.label} (loading...)`;const r=n.length;n.push(null);const l=await window.fetch(t.url);n[r]=await e.createBuffer(await l.arrayBuffer()),h(o,t.label),r===i&&(a.signal=n[r])}else if("sine"===t.type){const e=t.frequency||440;o.innerText=t.label||`${e} Hz sine`,n.push({type:"sine",frequency:e,gain:t.gain||.5})}else"noise"===t.type&&(o.innerText=t.label||"Noise",n.push({type:"noise",filter:t.filter||[],gain:t.gain||.5}));c()})),s.onclick=function(){e.stop(),c()},l.onclick=function(){const t=a.selection;null!==t?e.start(n[i],t.start,t.end):e.start(n[i]),c()};const d=r.children[1],p=d.children[0],m=document.createElement("input");m.type="file",m.accept="audio/*",m.addEventListener("change",(async t=>{const i=t.target.files[0];if(!i)return;const o=document.createElement("div");o.setAttribute("data-source-idx",n.length),o.innerText=`${i.name} (loading...)`,u(o),d.insertBefore(o,p);const r=n.length;o.addEventListener("click",(e=>{u(e.target)})),n.push(null);const l=await new Promise((e=>{const t=new FileReader;t.onload=t=>{e(t.target.result)},t.readAsArrayBuffer(i)}));n[r]=await e.createBuffer(l),h(o,i.name),c()}),!1),0===t.length?o.children[0].innerText="input signal":u(r.children[0].children[0]),p.addEventListener("click",(()=>{m.click()})),a.addEventListener("clicked",(t=>{e.stop(),e.start(n[i],t.position),c()})),a.addEventListener("selected",(t=>{e.stop(),e.start(n[i],t.startPos,t.endPos),c()}));const v=()=>{a.playbackPosition=e.position,setTimeout((()=>requestAnimationFrame(v)),40)};v()}void 0===Math.log10&&(Math.log10=function(e){return Math.LOG10E*Math.log(e)}),void 0===AnalyserNode.prototype.getFloatTimeDomainData&&(AnalyserNode.prototype.getFloatTimeDomainData=function(e){const t=new Uint8Array(e.length);this.getByteTimeDomainData(t);for(let n=0;n<e.length;n++)e[n]=(t[n]-128)/128}),void 0===document.createElement("input").labels&&Object.defineProperty(HTMLInputElement.prototype,"labels",{get(){return document.querySelectorAll(`label[for=${this.id}]`)}}),"serviceWorker"in navigator&&window.addEventListener("load",(async()=>{try{await navigator.serviceWorker.register("sw.js",{type:"module"})}catch(e){console.warn("ServiceWorker registration failed: ",e)}}));export{a as FunctionGraph,c as SignalGraph,u as setupAudio,h as setupPlayerControls};!function(){function e(e,t){var n=document.createElement("iframe");n.style.cssText="position:absolute;left:0;top:-999px;width:1px;height:1px;",t.appendChild(n);var i=n.contentWindow,o=i.document,r="var window,$hook";for(var l in i)l in e||"eval"===l||(r+=",",r+=l);for(var s in e)r+=",",r+=s,r+="=self.",r+=s;var a=o.createElement("script");a.appendChild(o.createTextNode('function $hook(self,console) {"use strict";\n        '+r+";return function() {return eval(arguments[0])}}")),o.body.appendChild(a),this.exec=i.$hook(e,console)}var t,n=[];function i(e){for(var t=[],n=0;n<e.numberOfChannels;n++)t[n]=e.getChannelData(n);return t}function o(e){return e.$$processors||(e.$$processors={})}"function"!=typeof AudioWorkletNode&&(self.AudioWorkletNode=function(e,r,l){var s=o(e)[r],a=e.createScriptProcessor(void 0,2,l&&l.outputChannelCount?l.outputChannelCount[0]:2),c=new Map;function u(e,t){this.eventTime=t,this.v=e}function f(e,t){this.eventTime=t,this.v1=e}function h(e,t){this.eventTime=t,this.v1=e}function d(e,t,n){this.eventTime=t,this.v1=e,this.tau=n}function p(e,t,n){this.eventTime=t,this.values=e,this.duration=n}function m(e,t,n){e.v0=t,e.t0=n}function v(t,n){for(var i=c.get(t),o=i.length-1;o>=0&&i[o].eventTime>n.eventTime;)o--;if(-1===o){var r=a.parameters.get(t).value,l=e.currentTime;n instanceof u?m(n,r,l):(i.splice(0,0,new u(r,l)),o=0)}i.splice(o+1,0,n)}if(u.prototype.func=function(e){return e>=this.eventTime?this.v:this.v0},f.prototype.func=function(e){return e>=this.eventTime?this.v1:e<=this.t0||this.v1*this.v0<=0?this.v0:this.v0*Math.pow(this.v1/this.v0,(e-this.t0)/(this.eventTime-this.t0))},h.prototype.func=function(e){return e>=this.eventTime?this.v1:e<=this.t0?this.v0:this.v0+(this.v1-this.v0)*(e-this.t0)/(this.eventTime-this.t0)},d.prototype.func=function(e){return e<=this.eventTime?this.v0:this.v1+(this.v0-this.v1)*Math.exp((this.eventTime-e)/this.tau)},p.prototype.func=function(e){if(e<=this.eventTime)return this.v0;var t=this.duration/(this.values.length-1),n=Math.floor((e-this.eventTime)/t);return n>=this.values.length-1?this.values[this.values.length-1]:this.values[n]+(this.values[n+1]-this.values[n])*(e-(n*t+this.eventTime))/t},a.parameters=new Map,s.properties)for(var g=function(){var t=s.properties[y],n=e.createGain().gain;n.value=t.defaultValue,n.cancelAndHoldAtTime=function(e){for(var n=c.get(t.name),i=0;i<n.length&&n[i].eventTime<=e;)i++;var o=i>0?n[i-1]:null,r=i<n.length?n[i]:null;if(r instanceof h||r instanceof f){for(var l=1;l<=i;l++){var s=n[l-1].eventTime;m(n[l],n[l-1].func(s),s)}r.v1=r.func(e),r.eventTime=e,i+=1}else if(o instanceof d){for(var a=1;a<i;a++){var v=n[a-1].eventTime;m(n[a],n[a-1].func(v),v)}n.splice(i,0,new u(o.func(e),e)),i+=1}else if(o instanceof p&&e<o.eventTime+o.duration){var g=o.func(e),y=Math.floor((e-o.eventTime)/o.duration*o.values.length);o.duration=y/o.values.length*o.duration,o.values.splice(y),n.splice(i,0,new h(g,e))}n.splice(i)},n.cancelScheduledValues=function(e){for(var n=c.get(t.name),i=0;i<n.length&&n[i].eventTime<=e;)i++;n.splice(i);for(var o=1;o<i;o++){var r=n[o-1].eventTime;m(n[o],n[o-1].func(r),r)}i>0&&n.push(new u(n[i-1].func(e),e))},n.exponentialRampToValueAtTime=function(n,i){i<e.currentTime&&(i=e.currentTime),v(t.name,new f(n,i))},n.linearRampToValueAtTime=function(n,i){i<e.currentTime&&(i=e.currentTime),v(t.name,new h(n,i))},n.setTargetAtTime=function(n,i,o){i<e.currentTime&&(i=e.currentTime),v(t.name,new d(n,i,o))},n.setValueAtTime=function(e,n){v(t.name,new u(e,n))},n.setValueAtTime=function(n,i,o){i<e.currentTime&&(i=e.currentTime),v(t.name,new p(Array.from(n),i,o))},a.parameters.set(t.name,n),c.set(t.name,[])},y=0;y<s.properties.length;y++)g();var T=new MessageChannel;t=T.port2;var b=new s.Processor(l||{});return t=null,a.port=T.port1,a.processor=s,a.instance=b,a.onaudioprocess=function(t){var o=this,r={},l=-1;this.parameters.forEach((function(t,i){var s=n[++l]||(n[l]=new Float32Array(o.bufferSize)),a=c.get(i);if(0===a.length)s.fill(t.value);else{for(var u=0;u<s.length;u++){for(var f=e.currentTime+u/e.sampleRate;0!==a.length&&f>a[0].eventTime;){if(a[0]instanceof d){if(a.length<2)break;if(a[1]instanceof d&&f<a[1].eventTime)break;t.value=a[0].func(a[1].eventTime)}else if(a[0]instanceof p){if(f<a[0].eventTime+a[0].duration)break;t.value=a[0].values[a[0].values.length-1]}else t.value=a[0].func(a[0].eventTime);a.shift(),0!==a.length&&m(a[0],t.value,f)}if(0===a.length){s.fill(t.value,u);break}s[u]=a[0].func(f)}t.value=s[s.length-1]}r[i]=s})),this.processor.realm.exec("self.sampleRate=sampleRate="+this.context.sampleRate+";self.currentTime=currentTime="+this.context.currentTime);var s=i(t.inputBuffer),a=i(t.outputBuffer);this.instance.process([s],[a],r)},a},Object.defineProperty((self.AudioContext||self.webkitAudioContext).prototype,"audioWorklet",{get:function(){return this.$$audioWorklet||(this.$$audioWorklet=new self.AudioWorklet(this))}}),self.AudioWorklet=function(){function n(e){this.$$context=e}return n.prototype.addModule=function(n,i){var r=this;return fetch(n).then((function(e){if(!e.ok)throw Error(e.status);return e.text()})).then((function(n){var l={sampleRate:0,currentTime:0,AudioWorkletProcessor:function(){this.port=t},registerProcessor:function(e,t){o(r.$$context)[e]={realm:s,context:l,Processor:t,properties:t.parameterDescriptors||[]}}};l.self=l;var s=new e(l,document.documentElement);return s.exec((i&&i.transpile||String)(n)),null}))},n}())}();